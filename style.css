/* -------- Reset -------- */
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: "Nunito", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", sans-serif;
  color: #3a2b2f; background: #ffeef6;
}

/* -------- Utilidades -------- */
.hidden { display: none !important; }
.btn-main{
  background: linear-gradient(135deg, #ff8fb1, #ff5d8f);
  color:#fff;border:0;padding:12px 18px;border-radius:14px;
  box-shadow:0 8px 20px rgba(255,93,143,.35);
  font-weight:800;cursor:pointer;transition:.15s;
}
.btn-main:hover{ transform:translateY(-1px); box-shadow:0 10px 24px rgba(255,93,143,.4); }

.screen{ min-height:100vh; display:grid; place-items:center; padding:24px; }

/* -------- PORTADA -------- */
.cover-screen{
  position:fixed; inset:0; z-index:9999;
  display:grid; place-items:center;
  background:
    radial-gradient(1200px 600px at 50% -200px, rgba(255,200,220,.45), rgba(255,255,255,0) 60%),
    linear-gradient(180deg, #ffd6e6 0%, #fff0c2 55%, #fbeada 100%);
}
.cover-wrap{ position:relative; width:100%; max-width:1000px; padding:16px; text-align:center; }
.cover-art{
  width:min(92vw, 960px); height:auto; display:block; margin:0 auto;
  border-radius:16px; box-shadow:0 18px 40px rgba(0,0,0,.18);
  user-select:none; -webkit-user-drag:none; object-fit:contain;
}
.cover-start{
  position:absolute; left:50%;
  bottom: clamp(18px, 7vh, 80px);
  transform: translateX(-50%);
  padding:14px 22px; font-size:clamp(16px,2.4vw,18px);
}

/* -------- Selecci√≥n -------- */
#selectScreen{
  background:
    radial-gradient(1200px 600px at 50% -200px, rgba(255,200,220,.55), rgba(255,255,255,0) 60%),
    linear-gradient(180deg, #ffd6e6 0%, #fff0c2 55%, #fbeada 100%);
  position:relative; overflow:hidden; z-index:1;
}
#selectScreen::before,#selectScreen::after{
  content:"‚ù§ üê¢ ‚ù§"; position:absolute; font-size:72px; opacity:.08; animation:floaty 12s linear infinite;
}
#selectScreen::before{ top:10%; left:6%; }
#selectScreen::after{ bottom:8%; right:6%; transform:scale(.9) rotate(10deg); }
@keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(10px)}100%{transform:translateY(0)}}

.select-wrap{text-align:center;}
.select-title{ margin:0 0 18px; font-weight:900; color:#ff5d8f; text-shadow:0 2px 0 #ffd0df; }
.choices-container{ display:flex;gap:22px;flex-wrap:wrap;align-items:center;justify-content:center;margin-bottom:12px; }

.char-card{
  background:rgba(255,255,255,.86); backdrop-filter:blur(6px); border:2px solid #ffd0df;
  border-radius:20px; padding:16px 16px 12px; width:220px; text-align:center; cursor:pointer;
  transition:transform .15s ease, box-shadow .15s ease; box-shadow:0 10px 24px rgba(255,93,143,.18);
}
.char-card:hover{ transform:translateY(-3px); box-shadow:0 12px 28px rgba(255,93,143,.28); }

.preview{
  width:160px;height:160px;margin:0 auto 10px;border-radius:50%;
  position:relative; display:grid;place-items:center; overflow:hidden;
  background: radial-gradient(circle at 40% 35%, #fff, #ffe7ef 60%, #ffd8e5 80%);
  border: 6px solid rgba(255,176,200,.8);
  box-shadow:
    0 0 0 10px rgba(255,208,223,.35),
    inset 0 10px 18px rgba(255,255,255,.6),
    inset 0 -10px 18px rgba(255,150,180,.25),
    0 14px 28px rgba(255,93,143,.18);
}
.preview canvas{
  width:128px;height:128px;
  image-rendering: auto; /* mantenemos est√©tica suave */
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.20));
  border-radius: 50%;
  overflow: hidden;
}
.select-note{ opacity:.7 }

/* -------- Lock & Welcome -------- */
.glass-box,.welcome-box{
  background:rgba(255,255,255,.86); border:2px solid #ffd0df; border-radius:18px; padding:22px; text-align:center;
  box-shadow:0 10px 24px rgba(0,0,0,.06);
}
.glass-box{ max-width:320px;width:100%; }
.glass-box input{
  width:100%;margin:12px 0 16px;border:2px solid #ffc3d6;border-radius:12px;padding:10px 12px;outline:none;
}
.welcome-box{ max-width:380px; position:relative; z-index:2; }
#startParticles{ position:absolute; inset:0; overflow:hidden; z-index:1; pointer-events:none; }
.fall-item{ position:absolute; top:-10vh; animation:fall linear forwards; filter: drop-shadow(0 4px 10px rgba(0,0,0,.15)); }
@keyframes fall{ to{ transform:translateY(115vh) rotate(18deg); opacity:.95 }}

/* -------- Canvas juego -------- */
#gameCanvas{ display:block; width:100vw; height:100vh; background:transparent; }

/* -------- HUD -------- */
#hud{ position:fixed; inset:0 0 auto 0; pointer-events:none; z-index:10; }
.hud-audio{
  position:absolute; top:12px; right:14px; display:flex; align-items:center; gap:10px;
  background:rgba(255,255,255,.85); border:2px solid #ffd0df; border-radius:12px; padding:8px 10px;
  box-shadow:0 8px 18px rgba(0,0,0,.1); pointer-events:auto;
}
.btn-audio{ background:transparent; border:none; font-size:20px; cursor:pointer; }
.vol-range{ width:110px; accent-color:#ff5d8f; cursor:pointer; }
.ride-hint{
  position:absolute; top:60px; left:14px; background:rgba(255,255,255,.95);
  border:2px dashed #ffc3d6; border-radius:12px; padding:6px 10px; font-weight:700; color:#ff5d8f;
  box-shadow:0 6px 14px rgba(0,0,0,.08); pointer-events:auto;
}

/* -------- Toasts -------- */
#praiseContainer{ position:fixed; inset:0; pointer-events:none; z-index:35; }
.praise{
  position:absolute; top:30%; left:50%;
  transform:translate(-50%,-50%);
  background:rgba(255,255,255,.92); border:2px solid #ffd0df; border-radius:12px;
  padding:6px 10px; color:#ff5d8f; font-weight:800;
  box-shadow:0 10px 20px rgba(0,0,0,.12);
  animation:floatUp 900ms ease forwards;
}
@keyframes floatUp{
  0%{ transform:translate(-50%,-30%); opacity:0 }
  40%{ opacity:1 }
  100%{ transform:translate(-50%,-70%); opacity:0 }
}

/* -------- Overlays -------- */
.overlay{
  position:fixed; inset:0; display:grid; place-items:center;
  background:rgba(255,204,220,.35); backdrop-filter:blur(3px); z-index:40;
}
.overlay-card{
  background:rgba(255,255,255,.92); border:2px solid #ffd0df; border-radius:18px;
  padding:22px 26px; max-width:560px; box-shadow:0 12px 28px rgba(255,93,143,.18); text-align:center;
}
.poem-sm{ font-size:1.15rem; color:#64443a; }
.gameover-card{ padding:28px 32px; }
.gameover-title{
  margin:0 0 8px; font-size:2.2rem; letter-spacing:2px; color:#ff5d8f;
  text-shadow:0 2px 0 #ffd0df, 0 0 12px rgba(255,85,143,.45);
}
.gameover-sub{ margin:4px 0 14px; font-weight:700; color:#6a4b54; }

/* -------- Poema final -------- */
#heartsContainer{ position:fixed; inset:0; pointer-events:none; overflow:hidden; }
.poem-card{
  background:rgba(255,255,255,.9); border:2px solid #ffd0df; border-radius:18px;
  padding:24px 28px; max-width:560px; margin:0 16px; box-shadow:0 12px 28px rgba(255,93,143,.18);
}
.poem{ font-size:1.2rem; line-height:1.6; }
.signature{ display:inline-block; margin-top:8px; color:#ff5d8f; font-weight:700; }

/* --- Lluvias de corazones (final y game over) --- */
.heart-fall, .broken-heart {
  position: fixed; top: -8vh; pointer-events: none;
  animation: fall linear forwards; filter: drop-shadow(0 6px 10px rgba(0,0,0,.18)); z-index:45;
}
.broken-heart { color:#ff4d6d; transform: rotate(-12deg); opacity:.95; }
@keyframes fall { to { transform: translateY(115vh) rotate(18deg); opacity:.96; } }